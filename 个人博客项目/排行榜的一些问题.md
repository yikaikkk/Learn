# 关于排行榜的一些问题总结

## 背景
对于博客的排行榜功能已经做完了[排行榜的实现](http://guilinz.online/articles/187)

## 一些问题

### 大key
当排行榜中的数量过多时，就会导致大key问题

ZSet 是跳表 + hash 表结构，单元素几十字节起步
	•	单 key 过大：
	•	RDB / AOF 重写阻塞
	•	主从同步慢
	•	删除或重建排行榜会卡顿

之前考虑过大key问题[redis大key](http://guilinz.online/articles/163)

一些补充想法：
- 只存 Top N：控制内存上限
- 用户行为 → Kafka
→ Flink 聚合（1s 或 5s）
→ 批量 ZINCRBY

- 全量排行榜放在 ClickHouse / Doris（OLAP）

| 层级	| 技术|
|------|-----|
|实时热榜|	Redis ZSet TopN
|近线榜	|Flink 状态 / RocksDB
|全量榜	|ClickHouse / HBase
|展示缓存	|Redis / 本地缓存