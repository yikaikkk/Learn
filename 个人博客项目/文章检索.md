# 检索
项目提供了检索功能，主要基于Es的全文检索实现的


## 数据同步
在创建文章的时候，保存的文章内容是在mysql，在写入mysql的时候是同步写入，从mysql同步到es中的时候采用异步的方式，利用maxwell监听mysql的binlog，实现从mysql到es中的数据同步效果


## Es具体实现

ES策略使用ik_max_word分词器支持中文检索

自动过滤已删除和非公开文章

```java
private NativeSearchQueryBuilder buildQuery(String keywords) {
    NativeSearchQueryBuilder nativeSearchQueryBuilder = new NativeSearchQueryBuilder();
    BoolQueryBuilder boolQueryBuilder = QueryBuilders.boolQuery();
    // 标题或内容匹配关键词
    boolQueryBuilder.must(QueryBuilders.boolQuery().should(QueryBuilders.matchQuery("articleTitle", keywords))
                    .should(QueryBuilders.matchQuery("articleContent", keywords)))
            .must(QueryBuilders.termQuery("isDelete", FALSE))  // 未删除
            .must(QueryBuilders.termQuery("status", PUBLIC.getStatus()));  // 公开状态
    nativeSearchQueryBuilder.withQuery(boolQueryBuilder);
    return nativeSearchQueryBuilder;
}
```

