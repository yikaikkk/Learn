# 池化技术

## 背景
在最近做的一些项目中，作为基础服务，会给别人提供一些SDK，为了保证使用上的高性能，会在封装sdk时使用一些池化技术

## 连接池
在一个在线服务的sdk中使用了连接池，分别是rpc底层连接的连接池和对于在线服务的http连接的连接池。

	•	作用：复用 TCP 连接，提高请求效率。
	•	原理：
        •	对同一目标服务维持若干 TCP 连接。
        •	请求发出时重用已有连接而不是重新握手。

常见的其他连接池还有数据库连接池，java中常见的有HikariCP、Druid等，原理和http连接池一样

	•	启动时创建一定数量的数据库连接（最小连接数）。
	•	连接被客户端借用后用完归还池中。
	•	池内维护空闲连接和活动连接。
	•	可配置最大连接数、空闲超时时间等。
### 连接池核心原理总结
	1.	复用连接，减少重复开销。
	2.	管理资源，控制最大连接数防止过载。
	3.	空闲回收/超时机制，保证池不被占满。
	4.	线程安全，多线程/协程环境下安全借还连接。

## 对象池
在另一个sdk中，他主要用于保存一些数据调用信息，预先创建了一个环形数组，每次需要写就从中使用预先创建好的对象。

	•	预先创建一定数量的对象放入池中（空闲对象）。
	•	客户端需要对象时从池中获取，使用完毕后归还池中，而不是销毁。
	•	通过复用减少频繁创建/销毁对象的开销。

对象池的一些优点

	1.	减少重复创建和销毁开销。
	2.	降低 GC 压力（尤其是大对象）。
	3.	提高性能，尤其是频繁创建大对象的场景。

而在多线程高并发的情况下，对象池如果涉及到修改，则需要考虑到并发问题。

为了保证性能，在sdk开发中选择了使用无锁结构来处理，这个在之前的复盘中提到过[无锁队列](http://guilinz.online/articles/165)